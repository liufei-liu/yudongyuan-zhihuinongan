<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1">
		<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="email=no">
		<meta http-equiv="Expires" content="0">
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="Cache-control" content="no-cache">
		<meta http-equiv="Cache" content="no-cache">
		<title>优品名称</title>
		<meta name="keywords" content="">
		<meta name="Description" content="">
		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" href="css/public.css">
		<link rel="stylesheet" href="css/main.css">
		<script src="js/jquery.js"></script>
	</head>

	<body style="background-color:#fff;">
		<div class="header_box">
			<div class="header">
				<a class="back mui-action-back">
					<img src="images/back.png" alt="">
				</a>
				<h1>优品名称</h1>
				<a class="home ">
					<img src="images/home.png" alt="" />
				</a>
			</div>
		</div>
		<form id="form_info" action="" method="post" class="register_list">
			<input type="hidden" name="token" />
			<input type="hidden" name="REGISTRATION_ID" />
			<input type="hidden" name="EN_USER_ID" />
			<ul>
				<li>
					<span>优品名称：</span>
					<div>
						<input type="text" name="PRODUCT_NAME" value="" placeholder="请输入优品名称" />
						<div>
							<span class=""></span>
						</div>
					</div>
				</li>
			</ul>
			<div class="submit_btn_box ">
				<button id='reg' class="bozhong_submit">提交</button>
			</div>
		</form>

		<script src="../js/mui.min.js"></script>
		<script src="js/jquery.form.min.js"></script>
		<script src="js/init.js"></script>
		<script src="js/public.js"></script>
		<script>
			mui.init({
				gestureConfig: {
					release: true
				}
			});
			mui.plusReady(function() {
				/*提交表单的返回*/
				var can_back = true;
				$("body").on("keyup", function() {
					can_back = false;
				})
				var old_back = mui.back;
				mui.back = function() {
					if (can_back) {
						old_back();
					} else {
						var btnArray = ['否', '是'];
						mui.confirm('确认要返回么，确认？', TITLE, btnArray, function(e) {
							if (e.index == 1) {
								old_back();
							}
						})
					}
				}
				var _self = plus.webview.getWebviewById('wodeyoupin_child.html');
				var REGISTRATION_ID = _self.registration_id;
				var PRO_BATCH_NAME = _self.pro_batch_name;
				console.log(REGISTRATION_ID)
				$("input[name='token']").val(getToken());
				$("input[name='REGISTRATION_ID']").val(REGISTRATION_ID);
				$("input[name='EN_USER_ID']").val(getState().en_user_id);
				var options = {
					url: www_v + "/superior_products/add_superior_name",
					beforeSubmit: function() {
						if (wainshow() == false) {
							return false;
						};
						if (unsafe_tap2()) return false; // 调用代码
						if ($("input[name='PRODUCT_NAME']").val().trim() == "") {
							plus.nativeUI.toast("优品名称不能为空");
							return false;
						}
					},
					success: function(data) {
						console.log(JSON.parse(data).message);
						check_ajax(data, function(data) {
							//console.log(JSON.stringify(data));
							plus.nativeUI.toast('修改成功');
							old_back();
						})
					},
					error: function(e) {
						alert("服务端错误");
					}
				};
				$("#form_info").ajaxForm(options);
				if (wainshow() == false) {
					return false;
				};
				$.ajax(www_v + "/superior_products/product_name", {
					data: {
						"REGISTRATION_ID": REGISTRATION_ID,
						"token": getToken()
					},
					type: 'post', //HTTP请求类型
					timeout: 50000, //超时时间设置为10秒；
					success: function(data) {
						check_ajax(data, function(data) {
							//console.log(data);
							$("input[name='PRODUCT_NAME']").val(data);
						})
					},
					error: function(xhr, type, errorThrown, selfs) {
						if (type == "timeout") {
							alert("请求超时");
						} else if (type == "abort") {
							alert("请检查您的网络");
						} else if (type == "error") {
							alert("服务端错误");
						}
					}
				});
			})
		</script>
	</body>

</html>
